public static void assignItemCountConcurrently(List<Record> records) {
        ConcurrentHashMap<String, Set<String>> itemCountMap = new ConcurrentHashMap<>();

        // Populate the itemCountMap in a thread-safe manner
        records.parallelStream().forEach(record -> {
            itemCountMap.computeIfAbsent(record.getAddress(), k -> new CopyOnWriteArraySet<>()).add(record.getItemNo());
        });

        // Assign the count to each record
        records.parallelStream().forEach(record -> {
            int count = itemCountMap.get(record.getAddress()).size();
            synchronized (record) {
                record.setItemCount(count);
            }
        });
    }
