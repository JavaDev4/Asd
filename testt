SELECT 
    sub.id,
    sub.earliest_future_date,
    CASE 
        WHEN sub.earliest_future_date = sub.dis_dt_1 THEN sub.disb_amount_1
        WHEN sub.earliest_future_date = sub.dis_dt_2 THEN sub.disb_amount_2
        WHEN sub.earliest_future_date = sub.dis_dt_3 THEN sub.disb_amount_3
        ELSE 0
    END AS corresponding_amount
FROM (
    SELECT 
        id,
        dis_dt_1,
        disb_amount_1,
        dis_dt_2,
        disb_amount_2,
        dis_dt_3,
        disb_amount_3,
        LEAST(
            CASE WHEN dis_dt_1 > SYSDATE THEN dis_dt_1 ELSE DATE '9999-12-31' END,
            CASE WHEN dis_dt_2 > SYSDATE THEN dis_dt_2 ELSE DATE '9999-12-31' END,
            CASE WHEN dis_dt_3 > SYSDATE THEN dis_dt_3 ELSE DATE '9999-12-31' END
        ) AS earliest_future_date
    FROM 
        loan_disbursements
) sub;
